<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="https://onsenix12.github.io/evonik-dashboard/">
    <title>Plant Production Dashboard - Evonik</title>
    <link rel="stylesheet" href="shared-styles-new.css">
    <style>
        /* Page-specific styles for production.html */
        .header {
            background: linear-gradient(135deg, var(--production-indigo) 0%, #4F46E5 100%);
        }

        .back-btn:hover {
            color: var(--production-indigo);
        }

        .units-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .unit-card {
            background: var(--bg-gray);
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid var(--border-gray);
        }

        .unit-card.offline {
            border-color: var(--alert-red);
            background: rgba(220, 38, 38, 0.05);
        }

        .unit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-gray);
        }

        .unit-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .unit-status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge-online {
            background: rgba(22, 163, 74, 0.2);
            color: var(--success-green);
        }

        .badge-offline {
            background: rgba(220, 38, 38, 0.2);
            color: var(--alert-red);
        }

        .unit-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .unit-metric {
            text-align: center;
            padding: 0.75rem;
            background: white;
            border-radius: 8px;
        }

        .unit-metric-label {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .unit-metric-value {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .sensor-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .sensor-card {
            background: var(--bg-gray);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--success-green);
        }

        .sensor-card.warning {
            border-left-color: var(--warning-orange);
        }

        .sensor-card.critical {
            border-left-color: var(--alert-red);
        }

        .sensor-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .sensor-value {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .sensor-status {
            font-size: 0.75rem;
            color: var(--success-green);
        }

        .sensor-status.warning {
            color: var(--warning-orange);
        }

        .sensor-status.critical {
            color: var(--alert-red);
        }

        .shift-performance {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .shift-hour {
            background: var(--bg-gray);
            padding: 0.75rem;
            border-radius: 8px;
            text-align: center;
        }

        .shift-hour.current {
            border: 2px solid var(--production-indigo);
            background: rgba(99, 102, 241, 0.1);
        }

        .shift-hour.above-target {
            background: rgba(22, 163, 74, 0.1);
        }

        .shift-hour.below-target {
            background: rgba(234, 88, 12, 0.1);
        }

        .hour-label {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .hour-value {
            font-size: 1rem;
            font-weight: 600;
        }

        .maintenance-timeline {
            margin-top: 1rem;
        }

        .maintenance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--bg-gray);
            border-radius: 8px;
            border-left: 4px solid var(--production-indigo);
        }

        .maintenance-item.urgent {
            border-left-color: var(--alert-red);
            background: rgba(220, 38, 38, 0.05);
        }

        .maintenance-item.upcoming {
            border-left-color: var(--warning-orange);
        }

        .maintenance-info {
            flex: 1;
        }

        .maintenance-unit {
            font-weight: 600;
            color: var(--text-dark);
        }

        .maintenance-desc {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }

        .maintenance-date {
            font-weight: 500;
            color: var(--production-indigo);
            text-align: right;
        }

        /* Forecast Styles */
        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .forecast-week {
            background: var(--bg-gray);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--production-indigo);
        }

        .forecast-week h4 {
            color: var(--text-dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .forecast-details {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .forecast-metric {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-gray);
        }

        .forecast-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .forecast-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }

        .forecast-subtext {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .forecast-impact {
            background: rgba(234, 88, 12, 0.05);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(234, 88, 12, 0.2);
        }

        .forecast-impact h4 {
            color: var(--warning-orange);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .impact-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }

        .impact-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-gray);
        }

        .impact-icon {
            font-size: 1.5rem;
        }

        .impact-content {
            flex: 1;
        }

        .impact-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .impact-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        @media (max-width: 1024px) {
            .units-grid {
                grid-template-columns: 1fr;
            }

            .sensor-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .shift-performance {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 768px) {
            .sensor-grid {
                grid-template-columns: 1fr;
            }

            .shift-performance {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">üè≠ Evonik</div>
                <div>
                    <div style="font-size: 1.2rem; font-weight: 600;">Plant Production Operations</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">Real-Time Monitoring - Jurong Island</div>
                </div>
            </div>
            <div class="user-info">
                <div id="userName" style="font-size: 1.1rem; font-weight: 600;">Alex Rodriguez</div>
                <div id="userTitle" style="font-size: 0.9rem; opacity: 0.9;">Production Manager</div>
            </div>
        </div>
    </header>

    <nav class="back-nav">
        <div class="nav-content">
            <a href="index-new.html" class="back-btn">‚Üê Back to Coordination Hub</a>
            <a href="optimizer-new.html" class="optimizer-btn">
                AI Decision Support
            </a>
            <div class="breadcrumb">Plant Production</div>
        </div>
    </nav>

    <div class="alerts-banner" id="alertsBanner">
        <strong>EQUIPMENT ALERT:</strong> <span id="alertMessage"></span>
    </div>

    <main class="main-content">
        <!-- Production Overview -->
        <h2 class="section-title">Production Overview</h2>
        <div class="dashboard-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Overall Status</div>
                    <div class="card-status status-operational" id="overallStatus">Operational</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Current Output</div>
                    <div class="metric-value" id="totalOutput">965 MT/day</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Target Output</div>
                    <div class="metric-value">965 MT/day</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Capacity Utilization</div>
                    <div class="metric-value">100%</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Overall Equipment Effectiveness</div>
                    <div class="card-status status-operational">Excellent</div>
                </div>
                <div class="metric">
                    <div class="metric-label">OEE</div>
                    <div class="metric-value">94.2%</div>
                    <div class="metric-subtext">Above industry standard (85%)</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Availability</div>
                    <div class="metric-value">97.8%</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Performance</div>
                    <div class="metric-value">98.1%</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Quality Metrics</div>
                    <div class="card-status status-operational">On Target</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Quality Rate</div>
                    <div class="metric-value">98.5%</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Defects</div>
                    <div class="metric-value">0.8%</div>
                    <div class="metric-subtext">Within acceptable range (<2%)</div>
                </div>
            </div>
        </div>

        <!-- Equipment Status -->
        <div class="section-panel">
            <h3 class="section-title">Equipment Status - Real-Time Monitoring</h3>
            <div class="units-grid">
                <div class="unit-card" id="me5Card">
                    <div class="unit-header">
                        <div class="unit-name">ME5 Production Unit</div>
                        <div class="unit-status-badge badge-online" id="me5Status">Online</div>
                    </div>
                    <div class="unit-metrics">
                        <div class="unit-metric">
                            <div class="unit-metric-label">Current Output</div>
                            <div class="unit-metric-value" id="me5Output">620 MT/day</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Capacity</div>
                            <div class="unit-metric-value">620 MT/day</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Utilization</div>
                            <div class="unit-metric-value">100%</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Efficiency</div>
                            <div class="unit-metric-value" style="color: var(--success-green);">98.2%</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Runtime Today</div>
                            <div class="unit-metric-value">14.2 hrs</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Max Capacity</div>
                            <div class="unit-metric-value">775 MT/day</div>
                        </div>
                    </div>
                </div>

                <div class="unit-card" id="me6Card">
                    <div class="unit-header">
                        <div class="unit-name">ME6 Production Unit</div>
                        <div class="unit-status-badge badge-online" id="me6Status">Online</div>
                    </div>
                    <div class="unit-metrics">
                        <div class="unit-metric">
                            <div class="unit-metric-label">Current Output</div>
                            <div class="unit-metric-value" id="me6Output">345 MT/day</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Capacity</div>
                            <div class="unit-metric-value">345 MT/day</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Utilization</div>
                            <div class="unit-metric-value" id="me6Utilization">100%</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Efficiency</div>
                            <div class="unit-metric-value" style="color: var(--success-green);">96.8%</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Runtime Today</div>
                            <div class="unit-metric-value" id="me6Runtime">14.2 hrs</div>
                        </div>
                        <div class="unit-metric">
                            <div class="unit-metric-label">Max Capacity</div>
                            <div class="unit-metric-value">430 MT/day</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Equipment Health Monitoring -->
        <div class="section-panel">
            <h3 class="section-title">Equipment Health - Sensor Data (PIMS)</h3>
            <div class="sensor-grid">
                <div class="sensor-card">
                    <div class="sensor-label">ME5 Temperature</div>
                    <div class="sensor-value" id="me5Temp">142¬∞C</div>
                    <div class="sensor-status">Normal (140-145¬∞C)</div>
                </div>
                <div class="sensor-card">
                    <div class="sensor-label">ME5 Pressure</div>
                    <div class="sensor-value">2.3 bar</div>
                    <div class="sensor-status">Normal (2.0-2.5 bar)</div>
                </div>
                <div class="sensor-card">
                    <div class="sensor-label">ME5 Flow Rate</div>
                    <div class="sensor-value">85 m¬≥/h</div>
                    <div class="sensor-status">Normal</div>
                </div>
                <div class="sensor-card">
                    <div class="sensor-label">ME5 Vibration</div>
                    <div class="sensor-value">2.1 mm/s</div>
                    <div class="sensor-status">Normal (<3.0 mm/s)</div>
                </div>
                <div class="sensor-card" id="me6TempCard">
                    <div class="sensor-label">ME6 Temperature</div>
                    <div class="sensor-value" id="me6Temp">138¬∞C</div>
                    <div class="sensor-status" id="me6TempStatus">Normal (135-142¬∞C)</div>
                </div>
                <div class="sensor-card" id="me6PressureCard">
                    <div class="sensor-label">ME6 Pressure</div>
                    <div class="sensor-value" id="me6Pressure">2.1 bar</div>
                    <div class="sensor-status" id="me6PressureStatus">Normal (1.8-2.3 bar)</div>
                </div>
                <div class="sensor-card" id="me6FlowCard">
                    <div class="sensor-label">ME6 Flow Rate</div>
                    <div class="sensor-value" id="me6Flow">42 m¬≥/h</div>
                    <div class="sensor-status" id="me6FlowStatus">Normal</div>
                </div>
                <div class="sensor-card" id="me6VibrationCard">
                    <div class="sensor-label">ME6 Vibration</div>
                    <div class="sensor-value" id="me6Vibration">1.8 mm/s</div>
                    <div class="sensor-status" id="me6VibrationStatus">Normal (<3.0 mm/s)</div>
                </div>
            </div>
        </div>

        <!-- Shift Performance -->
        <div class="section-panel">
            <h3 class="section-title">Daily Production Performance</h3>
            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Daily Production Rate</div>
                        <div class="card-status status-operational">On Track</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Daily Production Rate</div>
                        <div class="metric-value" id="dailyRate">965 MT/day</div>
                        <div class="metric-subtext">Target: 965 MT/day</div>
                    </div>
                </div>
                <div class="card" style="grid-column: span 2;">
                    <div class="card-header">
                        <div class="card-title">Daily Summary</div>
                    </div>
                    <div class="daily-summary">
                        <div class="metric">
                            <div class="metric-label">Today's Production</div>
                            <div class="metric-value" id="todayProduction">782 MT</div>
                            <div class="metric-subtext">As of 2:30 PM | 81% of daily target</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Yesterday's Production</div>
                            <div class="metric-value">958 MT</div>
                            <div class="metric-subtext">99.3% of target</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">7-Day Average</div>
                            <div class="metric-value">963 MT/day</div>
                            <div class="metric-subtext">Consistent performance</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Production Trend (Daily) -->
        <div class="section-panel">
            <h3 class="section-title">Production Trend (Daily)</h3>
            <div style="background: white; padding: 1rem; border-radius: 12px; border: 1px solid var(--border-gray);">
                <canvas id="dailyTrendChart" height="120"></canvas>
            </div>
        </div>

        <!-- Safety Metrics -->
        <h2 class="section-title">Safety Performance</h2>
        <div class="dashboard-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Days Since Last Incident</div>
                    <div class="card-status status-operational">Excellent</div>
                </div>
                <div class="metric">
                    <div class="metric-value" style="color: var(--success-green);">287 days</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Near-Miss Reports</div>
                    <div class="card-status status-operational">Low</div>
                </div>
                <div class="metric">
                    <div class="metric-label">This Month</div>
                    <div class="metric-value">3</div>
                    <div class="metric-subtext">All investigated & resolved</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Safety Compliance</div>
                    <div class="card-status status-operational">100%</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Inspections Completed</div>
                    <div class="metric-value">18/18</div>
                    <div class="metric-subtext">October 2025</div>
                </div>
            </div>
        </div>

        <!-- 2-Week Forecast Visibility -->
        <div class="section-panel">
            <h3 class="section-title">üìÖ 2-Week Forecast Visibility</h3>
            <p style="color: var(--text-light); font-size: 0.9rem; margin: -0.5rem 0 1.5rem 0;">
                Forward-looking visibility for plant shutdowns and maintenance planning
            </p>
            
            <div class="forecast-grid">
                <div class="forecast-week">
                    <h4>Week 1 (Oct 28 - Nov 3)</h4>
                    <div class="forecast-details">
                        <div class="forecast-metric">
                            <div class="forecast-label">Production Capacity</div>
                            <div class="forecast-value">965 MT/day</div>
                            <div class="forecast-subtext">Full capacity expected</div>
                        </div>
                        <div class="forecast-metric">
                            <div class="forecast-label">Maintenance Windows</div>
                            <div class="forecast-value">None scheduled</div>
                            <div class="forecast-subtext">All units operational</div>
                        </div>
                        <div class="forecast-metric">
                            <div class="forecast-label">Incoming Shipments</div>
                            <div class="forecast-value">3 shipments</div>
                            <div class="forecast-subtext">Raw materials: 2,400 MT</div>
                        </div>
                    </div>
                </div>
                
                <div class="forecast-week">
                    <h4>Week 2 (Nov 4 - Nov 10)</h4>
                    <div class="forecast-details">
                        <div class="forecast-metric">
                            <div class="forecast-label">Production Capacity</div>
                            <div class="forecast-value">620 MT/day</div>
                            <div class="forecast-subtext">ME6 maintenance scheduled</div>
                        </div>
                        <div class="forecast-metric">
                            <div class="forecast-label">Maintenance Windows</div>
                            <div class="forecast-value">ME6 - 40hr cycle</div>
                            <div class="forecast-subtext">Nov 5-7: 3-day shutdown</div>
                        </div>
                        <div class="forecast-metric">
                            <div class="forecast-label">Incoming Shipments</div>
                            <div class="forecast-value">2 shipments</div>
                            <div class="forecast-subtext">Adjusted for maintenance</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="forecast-impact">
                <h4>‚ö†Ô∏è Maintenance Impact Analysis</h4>
                <div class="impact-grid">
                    <div class="impact-item">
                        <div class="impact-icon">üì¶</div>
                        <div class="impact-content">
                            <div class="impact-label">Raw Materials</div>
                            <div class="impact-value">1 shipment delayed</div>
                        </div>
                    </div>
                    <div class="impact-item">
                        <div class="impact-icon">üìä</div>
                        <div class="impact-content">
                            <div class="impact-label">Production Shortfall</div>
                            <div class="impact-value">-1,035 MT</div>
                        </div>
                    </div>
                    <div class="impact-item">
                        <div class="impact-icon">üë•</div>
                        <div class="impact-content">
                            <div class="impact-label">Customer Orders</div>
                            <div class="impact-value">3 orders rescheduled</div>
                        </div>
                    </div>
                    <div class="impact-item">
                        <div class="impact-icon">üí∞</div>
                        <div class="impact-content">
                            <div class="impact-label">Cost Impact</div>
                            <div class="impact-value">$25K opportunity cost</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Maintenance Schedule -->
        <div class="section-panel">
            <h3 class="section-title">Maintenance Schedule</h3>
            <div class="maintenance-timeline">
                <div class="maintenance-item urgent">
                    <div class="maintenance-info">
                        <div class="maintenance-unit">ME6 - Routine Inspection</div>
                        <div class="maintenance-desc">40-hour cycle maintenance required (6 times annually, 13 days total)</div>
                    </div>
                    <div class="maintenance-date">Due: Oct 25</div>
                </div>
                <div class="maintenance-item upcoming">
                    <div class="maintenance-info">
                        <div class="maintenance-unit">ME5 - H2S Catalyst Change</div>
                        <div class="maintenance-desc">Major maintenance: 40 days + 12.5 days loadup loss (every 3 years)</div>
                    </div>
                    <div class="maintenance-date">Scheduled: Q2 2026</div>
                </div>
                <div class="maintenance-item upcoming">
                    <div class="maintenance-info">
                        <div class="maintenance-unit">ME6 - H2S Catalyst Change</div>
                        <div class="maintenance-desc">Major maintenance: 42 days + 5 days loadup loss (every 6 years)</div>
                    </div>
                    <div class="maintenance-date">Scheduled: 2026</div>
                </div>
                <div class="maintenance-item">
                    <div class="maintenance-info">
                        <div class="maintenance-unit">Blackout Test</div>
                        <div class="maintenance-desc">Alternate year test affecting ME6 (3 days downtime)</div>
                    </div>
                    <div class="maintenance-date">Scheduled: 2026</div>
                </div>
                <div class="maintenance-item">
                    <div class="maintenance-info">
                        <div class="maintenance-unit">MAMP/UTO Maintenance</div>
                        <div class="maintenance-desc">January requirement: 5 days downtime for maintenance</div>
                    </div>
                    <div class="maintenance-date">Constraint: Jan 2026</div>
                </div>
            </div>
        </div>

        <!-- PIMS Integration Status -->
        <h2 class="section-title">PIMS Integration Status</h2>
        <div class="dashboard-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">PIMS Connection</div>
                    <div class="card-status status-operational" id="oasStatus">Connected</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Active Sensors</div>
                    <div class="metric-value">247/247</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Data Refresh Rate</div>
                    <div class="metric-value" style="font-size: 1rem;">1 minute</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Data Quality</div>
                    <div class="card-status status-operational">Excellent</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Signal Quality</div>
                    <div class="metric-value">99.8%</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Data Loss</div>
                    <div class="metric-value">0.2%</div>
                    <div class="metric-subtext">Within acceptable range</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">System Health</div>
                    <div class="card-status status-operational">Stable</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Last Sync</div>
                    <div class="metric-value" style="font-size: 1rem;">48 sec ago</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Sync Errors (24h)</div>
                    <div class="metric-value">0</div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Listen for coordination events
        window.addEventListener('storage', function(e) {
            if (e.key === 'evonik_coordination_event') {
                const eventData = JSON.parse(e.newValue);
                handleCoordinationEvent(eventData);
            }
        });

        function handleCoordinationEvent(event) {
            switch(event.type) {
                case 'equipment_failure':
                    showAlert('ME6 Unit Shutdown Detected');
                    simulateME6Failure();
                    break;
                case 'reset':
                    resetDashboard();
                    break;
            }
        }

        function showAlert(message) {
            const banner = document.getElementById('alertsBanner');
            document.getElementById('alertMessage').textContent = message;
            banner.classList.add('show');
            setTimeout(() => banner.classList.remove('show'), 8000);
        }

        function simulateME6Failure() {
            // Update ME6 unit card
            const me6Card = document.getElementById('me6Card');
            me6Card.classList.add('offline');
            document.getElementById('me6Status').className = 'unit-status-badge badge-offline';
            document.getElementById('me6Status').textContent = 'Offline';
            document.getElementById('me6Output').textContent = '0 MT/day';
            document.getElementById('me6Utilization').textContent = '0%';
            document.getElementById('me6Runtime').textContent = '0 hrs';
            
            // Update overall status
            document.getElementById('totalOutput').textContent = '620 MT/day';
            document.getElementById('overallStatus').className = 'card-status status-critical';
            document.getElementById('overallStatus').textContent = 'Degraded';
            
            // Update sensor readings to show failure
            document.getElementById('me6Temp').textContent = '-- ¬∞C';
            document.getElementById('me6TempCard').classList.add('critical');
            document.getElementById('me6TempStatus').textContent = 'No signal';
            document.getElementById('me6TempStatus').className = 'sensor-status critical';
            
            document.getElementById('me6Pressure').textContent = '-- bar';
            document.getElementById('me6PressureCard').classList.add('critical');
            document.getElementById('me6PressureStatus').textContent = 'No signal';
            document.getElementById('me6PressureStatus').className = 'sensor-status critical';
            
            document.getElementById('me6Flow').textContent = '0 m¬≥/h';
            document.getElementById('me6FlowCard').classList.add('critical');
            document.getElementById('me6FlowStatus').textContent = 'Unit offline';
            document.getElementById('me6FlowStatus').className = 'sensor-status critical';
            
            document.getElementById('me6Vibration').textContent = '-- mm/s';
            document.getElementById('me6VibrationCard').classList.add('critical');
            document.getElementById('me6VibrationStatus').textContent = 'No signal';
            document.getElementById('me6VibrationStatus').className = 'sensor-status critical';
        }

        function resetDashboard() {
            document.getElementById('alertsBanner').classList.remove('show');
            
            // Reset ME6
            const me6Card = document.getElementById('me6Card');
            me6Card.classList.remove('offline');
            document.getElementById('me6Status').className = 'unit-status-badge badge-online';
            document.getElementById('me6Status').textContent = 'Online';
            document.getElementById('me6Output').textContent = '345 MT/day';
            document.getElementById('me6Utilization').textContent = '100%';
            document.getElementById('me6Runtime').textContent = '14.2 hrs';
            
            // Reset overall status
            document.getElementById('totalOutput').textContent = '965 MT/day';
            document.getElementById('overallStatus').className = 'card-status status-operational';
            document.getElementById('overallStatus').textContent = 'Operational';
            
            // Reset sensors
            document.getElementById('me6Temp').textContent = '138¬∞C';
            document.getElementById('me6TempCard').classList.remove('critical');
            document.getElementById('me6TempStatus').textContent = 'Normal (135-142¬∞C)';
            document.getElementById('me6TempStatus').className = 'sensor-status';
            
            document.getElementById('me6Pressure').textContent = '2.1 bar';
            document.getElementById('me6PressureCard').classList.remove('critical');
            document.getElementById('me6PressureStatus').textContent = 'Normal (1.8-2.3 bar)';
            document.getElementById('me6PressureStatus').className = 'sensor-status';
            
            document.getElementById('me6Flow').textContent = '42 m¬≥/h';
            document.getElementById('me6FlowCard').classList.remove('critical');
            document.getElementById('me6FlowStatus').textContent = 'Normal';
            document.getElementById('me6FlowStatus').className = 'sensor-status';
            
            document.getElementById('me6Vibration').textContent = '1.8 mm/s';
            document.getElementById('me6VibrationCard').classList.remove('critical');
            document.getElementById('me6VibrationStatus').textContent = 'Normal (<3.0 mm/s)';
            document.getElementById('me6VibrationStatus').className = 'sensor-status';
        }

        // Update user display from localStorage
        function updateUserDisplay() {
            const userSession = localStorage.getItem('evonik_user_session');
            if (userSession) {
                try {
                    const session = JSON.parse(userSession);
                    const userNameEl = document.getElementById('userName');
                    const userTitleEl = document.getElementById('userTitle');
                    
                    if (userNameEl) {
                        userNameEl.textContent = session.name;
                    }
                    
                    if (userTitleEl) {
                        // Map role to title
                        const roleTitles = {
                            'supply_chain': 'Local Supply Chain Manager',
                            'plant_manager': 'Production Manager',
                            'sales': 'Regional Sales Manager',
                            'operations': 'Production Manager',
                            'management': 'Management'
                        };
                        userTitleEl.textContent = roleTitles[session.role] || 'User';
                    }
                } catch (error) {
                    console.error('Error parsing user session:', error);
                }
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateUserDisplay();
            console.log('Production Operations Dashboard initialized');
            console.log('PIMS real-time monitoring active');

            // Render Daily Trend Chart (Chart.js)
            if (window.Chart && document.getElementById('dailyTrendChart')) {
                const ctx = document.getElementById('dailyTrendChart').getContext('2d');
                const labels = ['Oct 1', 'Oct 2', 'Oct 3', 'Oct 4', 'Oct 5', 'Oct 6', 'Oct 7', 'Oct 8', 'Oct 9', 'Oct 10', 'Oct 11', 'Oct 12', 'Oct 13', 'Oct 14', 'Oct 15'];
                const data = [945, 972, 958, 961, 967, 955, 970, 968, 960, 964, 959, 961, 966, 969, 974];
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels,
                        datasets: [{
                            label: 'Daily Production (MT/day)',
                            data,
                            borderColor: getComputedStyle(document.documentElement).getPropertyValue('--production-indigo').trim() || '#6366F1',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            borderWidth: 2,
                            tension: 0.25,
                            pointRadius: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        scales: {
                            y: {
                                title: { display: true, text: 'MT/day' },
                                grid: { color: 'rgba(0,0,0,0.05)' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        },
                        plugins: {
                            legend: { display: true },
                            tooltip: { enabled: true }
                        }
                    }
                });
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>